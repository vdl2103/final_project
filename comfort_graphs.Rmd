---
title: "comfort_graphs"
author: "Nicole Comfort"
date: "11/19/2018"
output: github_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)

library(tidyverse)

knitr::opts_chunk$set(
  fig.width = 6,
  fig.asp = .6,
  out.width = "90%"
)

theme_set(theme_bw() + theme(legend.position = "bottom"))

```

## Nicole's EDA looking at humidity and heat index as variables of interest

# Heat Index

For people working outdoors in hot weather, both air temperature and humidity affect how hot they feel. The "heat index" is a single value that takes both temperature and humidity into account. The higher the heat index, the hotter the weather feels, since sweat does not readily evaporate and cool the skin. The heat index is a better measure than air temperature alone for estimating the risk to workers from environmental heat sources.

```{r start pitch speed & heat index, continuous}

# examine distribution of heat index
complete_db %>% 
  ggplot(aes(x = heat_index)) +
  geom_histogram()
# pretty much normally distributed overall

# distribution by stadium
complete_db %>% 
  ggplot(aes(x = heat_index, fill = team_name)) + 
  geom_density(alpha = .4, adjust = .5)
# we can see that there are some teams that have a broader distribution; places like San Diego the heat index is pretty stable; we can break up by regions in other analyses 

# basic scatterplot of pitch speed (all pitches) vs. heat index
complete_db %>% 
  ggplot(aes(x = heat_index, y = start_speed)) +
  geom_point(alpha = .3)
# not informative

# separate by region
# create new region variable
complete_db =
  dplyr::mutate(complete_db,
                region =
                  ifelse(team_name == "Baltimore Orioles" | team_name == "Boston Red Sox" |
                           team_name == "New York Yankees" | team_name == "Tampa Bay Rays", "al_east",
                  ifelse(team_name == "Atlanta Braves" | team_name == "Miami Marlins" |
                           team_name == "New York Mets" | team_name == "Philadelphia Phillies" |
                           team_name == "Washington Nationals", "nl_east",
                  ifelse(team_name == "Chicago White Sox" | team_name == "Cleveland Indians" |
                           team_name == "Detroit Tigers" | team_name == "Kansas City Royals" |
                           team_name == "Minnesota Twins", "al_central",
                  ifelse(team_name == "Chicago Cubs" | team_name == "Cincinnati Reds" |
                           team_name == "Milwaukee Brewers" | team_name == "Pittsburgh Pirates" |
                           team_name == "St. Louis Cardinals", "nl_central",
                  ifelse(team_name == "Houston Astros" | team_name == "Los Angeles Angels" |
                           team_name == "Oakland Athletics" | team_name == "Seattle Mariners" |
                           team_name == "Texas Rangers", "al_west",
                  ifelse(team_name == "Arizona Diamondbacks" | team_name == "Colorado Rockies" |
                           team_name == "Los Angeles Dodgers" | team_name == "San Diego Padres" |
                           team_name == "San Francisco Giants", "nl_west", "")))))))
# not sure why there is any group falling into the last "no" category...

# basic scatterplot of pitch speed vs. heat index, facet by pitch type
complete_db %>% 
  ggplot(aes(x = heat_index, y = start_speed)) +
  geom_point(alpha = .3) +
  facet_wrap(~pitch_type)
# too many points... let's use geom_hex
complete_db %>% 
  ggplot(aes(x = heat_index, y = start_speed, color = team_name)) +
  geom_hex() +
  facet_wrap(~pitch_type)
# very ugly and messy

# heat index distribution by region (now that I made the region variable)
complete_db %>% 
  ggplot(aes(x = heat_index, fill = region)) + 
  geom_density(alpha = .4, adjust = .5)

complete_db %>% 
  ggplot(aes(x = heat_index)) + 
  geom_density(alpha = .4, adjust = .5) +
  facet_wrap(~region)

# basic scatterplot of pitch speed vs. heat index, facet by pitch type, color by region
complete_db %>% 
  ggplot(aes(x = heat_index, y = start_speed, color = region)) +
  geom_point(alpha = .3) +
  facet_wrap(~pitch_type)
# the line looks pretty flat; appears there's no association between heat index and pitch speed.

# look at pitch speed (all pitches) vs. relative humidity
complete_db %>% 
  ggplot(aes(x = heat_index, y = start_speed)) +
  geom_hex() + 
  geom_smooth()
# again, looks like no association. maybe it dips slightly at the highest heat index, like above 35? Let me try to categorize heat index  

```

```{r start pitch speed & heat index, categorical}



```


# Relative Humidity 

Relative humidity is a measure of the amount of moisture in the air. Sweat does not evaporate as quickly when the air is moist as it does in a dry climate. Since evaporation of sweat from the skin is one of the ways the human body cools itself on a hot day, high humidity reduces our natural cooling potential and we feel hotter. Low humidity can also be a problem for outdoor workers in hot, desert-like climates. Sweat evaporates very rapidly in low humidity, which can lead to severe dehydration if a person does not drink enough water throughout the day.

```{r start pitch speed & humidity}

# scatterplot looking at pitch speed vs. relative humidity 
complete_db %>% 
  ggplot(aes(x = rh, y = start_speed, color = region)) +
  geom_point(alpha = .3) +
  facet_wrap(~pitch_type)

# maybe EP, FO, KN, PO, and SC are increasing speed with increasing relative humidity? Could change teh scale on the start_speed to better assess

# also, what pitch type is EP and SC? It looks like the only pitcher(s) throwing these belong to the american league central division 

# look at pitch speed (all pitches) vs. relative humidity
complete_db %>% 
  ggplot(aes(x = rh, y = start_speed)) +
  geom_hex() + 
  geom_smooth()
# again, looks like no association 


```

